.reveal
  .slides
    %section
      %h1 Perfect
      %p Send a postcard with ease.
      %h4 $2 to the US | $3 to everywhere else
      %button.zbutton.next Get Started

    %section.all-cards{data: {current: 0}}
      -s3 = AWS::S3.new
      -s3.buckets['post-perfect'].objects.with_prefix('postcards').map{|a| a.key.split("/")[1]}.uniq.each do |category|
        -cards = s3.buckets['post-perfect'].objects.with_prefix('postcards').select{|u| u.key[category] && u.key['.png']}
        -cards.each_slice(4).with_index do |row, i|
          %section.card-section{data: {background: s3.buckets['post-perfect'].objects.with_prefix('postcards').select{|u| u.key[category] && u.key['.png'] && u.key['background']}}}
            %h3 Choose a card
            %button.zbutton.small.prev Or go back
            .category-titles
              .previous-page
                %i.fa.fa-arrow-circle-o-left
              .category-name
                =category.split("-").map{|name| name.capitalize}.join(" ") + " "+ (i+1).to_s
              .next-page
                %i.fa.fa-arrow-circle-o-right
            .cards
              -row.each do |card|
                %img.card{src: "https://s3.amazonaws.com/post-perfect/#{card.key[0..-5]}.png?AWSAccessKeyId=#{ENV['AWS_KEY_ID']}"}

    %section
      %h3 Write your message
      %button.zbutton.small.prev Or go back
      %textarea.message{name: 'message', required: 'required', maxlength: 300}
      %button.zbutton.where Where should we send it?

    %section
      %h3 Tell us who it's going to
      %button.zbutton.small.prev Or go back
      =form_tag make_postcard_path, class: 'destination', parsley: {validate: true} do
        .field
          %label{for: 'name'} Name
          %input{name: 'name', required: 'required'}
        .field
          %label{for: 'address1'} Address Line 1
          %input{name: 'address1', required: 'required'}
        .field
          %label{for: 'address2'} Address Line 2
          %input{name: 'address2'}
        .field
          %label{for: 'city'} City
          %input{name: 'city', required: 'required'}
        .field
          %label{for: 'state'} State
          %input{name: 'state', required: 'required'}
        .field
          %label{for: 'country'} Country
          =select_tag :country, options_for_select(Carmen::Country.all.map{|c| [c.name, c.code]}, ['United States', 'US'])
        .field
          %label{for: 'zip'} Zip
          %input{name: 'zip', required: 'required'}
        .field
          %label{for: 'email'} Your Email
          %input#email{name: 'email', required: 'required'}
        =hidden_field_tag :photo_chosen, nil, class: 'photo-chosen'
        =hidden_field_tag :final_message, nil, class: 'final-message'
        =hidden_field_tag :payment_token

        %button.zbutton.purchase Send now